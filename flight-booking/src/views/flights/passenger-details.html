<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Passenger Details - SkyWay</title>
    <link href="/css/styles.css" rel="stylesheet">
</head>
<body class="bg-gray-50" x-data="{ 
    loading: true,
    currentStep: 1,
    totalSteps: 3,
    passengers: [],
    addonsSelected: {},
    currentPassenger: 1
}">
    <!-- Loading Skeleton -->
    <div x-show="loading" 
         x-init="setTimeout(() => { loading = false; initializePassengers(); }, 1000)"
         class="fixed inset-0 bg-white z-50 flex items-center justify-center">
        <div class="space-y-4 w-full max-w-3xl px-4">
            <div class="h-8 skeleton rounded-lg w-1/4 mx-auto"></div>
            <div class="h-64 skeleton rounded-lg"></div>
        </div>
    </div>

    <!-- Main Content -->
    <div x-show="!loading" 
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100">

        <!-- Progress Header -->
        <div class="bg-white border-b shadow-sm sticky top-0 z-40">
            <div class="max-w-7xl mx-auto px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <img src="/images/emirates-logo.png" alt="Emirates" class="w-12 h-12 object-contain">
                        <div>
                            <h2 class="font-bold">Passenger Information</h2>
                            <div class="flex items-center text-sm text-gray-600">
                                <span>Step</span>
                                <span class="mx-2" x-text="currentStep"></span>
                                <span>of</span>
                                <span class="mx-2" x-text="totalSteps"></span>
                            </div>
                        </div>
                    </div>
                    <div class="hidden md:block">
                        <div class="flex items-center space-x-8">
                            <div class="flex items-center" :class="{'text-primary-600': currentStep >= 1}">
                                <div class="w-8 h-8 rounded-full flex items-center justify-center border-2"
                                     :class="{'border-primary-600 bg-primary-600 text-white': currentStep >= 1,
                                             'border-gray-300': currentStep < 1}">
                                    1
                                </div>
                                <div class="ml-2">Details</div>
                            </div>
                            <div class="flex items-center" :class="{'text-primary-600': currentStep >= 2}">
                                <div class="w-8 h-8 rounded-full flex items-center justify-center border-2"
                                     :class="{'border-primary-600 bg-primary-600 text-white': currentStep >= 2,
                                             'border-gray-300': currentStep < 2}">
                                    2
                                </div>
                                <div class="ml-2">Add-ons</div>
                            </div>
                            <div class="flex items-center" :class="{'text-primary-600': currentStep >= 3}">
                                <div class="w-8 h-8 rounded-full flex items-center justify-center border-2"
                                     :class="{'border-primary-600 bg-primary-600 text-white': currentStep >= 3,
                                             'border-gray-300': currentStep < 3}">
                                    3
                                </div>
                                <div class="ml-2">Review</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="max-w-3xl mx-auto px-4 py-8">
            <!-- Passenger Details Form -->
            <div x-show="currentStep === 1">
                <div class="card">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold">Passenger Details</h3>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm text-gray-600">Passenger</span>
                            <span class="font-bold" x-text="currentPassenger"></span>
                            <span class="text-gray-600">/</span>
                            <span class="text-sm text-gray-600" x-text="passengers.length"></span>
                        </div>
                    </div>

                    <form @submit.prevent="savePassengerDetails" class="space-y-6">
                        <!-- Personal Information -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">First Name</label>
                                <input 
                                    type="text" 
                                    x-model="passengers[currentPassenger - 1].firstName"
                                    class="input-field"
                                    required>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Last Name</label>
                                <input 
                                    type="text"
                                    x-model="passengers[currentPassenger - 1].lastName"
                                    class="input-field"
                                    required>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Date of Birth</label>
                                <input 
                                    type="date"
                                    x-model="passengers[currentPassenger - 1].dob"
                                    class="input-field"
                                    required>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Gender</label>
                                <select 
                                    x-model="passengers[currentPassenger - 1].gender"
                                    class="input-field"
                                    required>
                                    <option value="">Select Gender</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Nationality</label>
                                <input 
                                    type="text"
                                    x-model="passengers[currentPassenger - 1].nationality"
                                    class="input-field"
                                    required>
                            </div>
                        </div>

                        <!-- Passport Information -->
                        <div class="border-t pt-6">
                            <h4 class="font-bold mb-4">Passport Details</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700">Passport Number</label>
                                    <input 
                                        type="text"
                                        x-model="passengers[currentPassenger - 1].passportNumber"
                                        class="input-field"
                                        required>
                                </div>
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700">Expiry Date</label>
                                    <input 
                                        type="date"
                                        x-model="passengers[currentPassenger - 1].passportExpiry"
                                        class="input-field"
                                        required>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Information -->
                        <div class="border-t pt-6">
                            <h4 class="font-bold mb-4">Contact Information</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700">Email</label>
                                    <input 
                                        type="email"
                                        x-model="passengers[currentPassenger - 1].email"
                                        class="input-field"
                                        required>
                                </div>
                                <div class="space-y-2">
                                    <label class="block text-sm font-medium text-gray-700">Phone Number</label>
                                    <input 
                                        type="tel"
                                        x-model="passengers[currentPassenger - 1].phone"
                                        class="input-field"
                                        required>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between pt-6">
                            <button 
                                type="button"
                                @click="previousPassenger"
                                x-show="currentPassenger > 1"
                                class="btn-secondary">
                                Previous Passenger
                            </button>
                            <button 
                                type="submit"
                                class="btn-primary">
                                <span x-text="currentPassenger === passengers.length ? 'Continue to Add-ons' : 'Next Passenger'"></span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Add-ons Selection -->
            <div x-show="currentStep === 2">
                <div class="card">
                    <h3 class="text-xl font-bold mb-6">Travel Add-ons</h3>

                    <div class="space-y-6">
                        <!-- Baggage -->
                        <div class="border-b pb-6">
                            <h4 class="font-bold mb-4">Extra Baggage</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="relative">
                                    <input 
                                        type="radio" 
                                        id="baggage-1" 
                                        name="baggage"
                                        x-model="addonsSelected.baggage"
                                        value="standard"
                                        class="sr-only">
                                    <label 
                                        for="baggage-1"
                                        :class="{'ring-2 ring-primary-600': addonsSelected.baggage === 'standard'}"
                                        class="block p-4 border rounded-lg cursor-pointer hover:border-primary-600 transition-colors">
                                        <span class="font-medium">Standard</span>
                                        <p class="text-sm text-gray-600">23kg included</p>
                                        <p class="font-bold mt-2">$0</p>
                                    </label>
                                </div>
                                <div class="relative">
                                    <input 
                                        type="radio" 
                                        id="baggage-2" 
                                        name="baggage"
                                        x-model="addonsSelected.baggage"
                                        value="extra"
                                        class="sr-only">
                                    <label 
                                        for="baggage-2"
                                        :class="{'ring-2 ring-primary-600': addonsSelected.baggage === 'extra'}"
                                        class="block p-4 border rounded-lg cursor-pointer hover:border-primary-600 transition-colors">
                                        <span class="font-medium">Extra</span>
                                        <p class="text-sm text-gray-600">+10kg (33kg total)</p>
                                        <p class="font-bold mt-2">$50</p>
                                    </label>
                                </div>
                                <div class="relative">
                                    <input 
                                        type="radio" 
                                        id="baggage-3" 
                                        name="baggage"
                                        x-model="addonsSelected.baggage"
                                        value="premium"
                                        class="sr-only">
                                    <label 
                                        for="baggage-3"
                                        :class="{'ring-2 ring-primary-600': addonsSelected.baggage === 'premium'}"
                                        class="block p-4 border rounded-lg cursor-pointer hover:border-primary-600 transition-colors">
                                        <span class="font-medium">Premium</span>
                                        <p class="text-sm text-gray-600">+20kg (43kg total)</p>
                                        <p class="font-bold mt-2">$90</p>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Meals -->
                        <div class="border-b pb-6">
                            <h4 class="font-bold mb-4">Special Meals</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <template x-for="meal in ['Regular', 'Vegetarian', 'Halal', 'Kosher', 'Diabetic', 'Child']">
                                    <div class="relative">
                                        <input 
                                            type="radio" 
                                            :id="'meal-' + meal.toLowerCase()" 
                                            name="meal"
                                            x-model="addonsSelected.meal"
                                            :value="meal.toLowerCase()"
                                            class="sr-only">
                                        <label 
                                            :for="'meal-' + meal.toLowerCase()"
                                            :class="{'ring-2 ring-primary-600': addonsSelected.meal === meal.toLowerCase()}"
                                            class="block p-4 border rounded-lg cursor-pointer hover:border-primary-600 transition-colors">
                                            <span class="font-medium" x-text="meal"></span>
                                            <p class="text-sm text-gray-600">Special dietary requirements</p>
                                        </label>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Airport Services -->
                        <div>
                            <h4 class="font-bold mb-4">Airport Services</h4>
                            <div class="space-y-4">
                                <label class="flex items-center justify-between p-4 border rounded-lg cursor-pointer hover:border-primary-600 transition-colors">
                                    <div class="flex items-center">
                                        <input 
                                            type="checkbox"
                                            x-model="addonsSelected.fastTrack"
                                            class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded">
                                        <span class="ml-3">
                                            <span class="font-medium">Fast Track Security</span>
                                            <p class="text-sm text-gray-600">Skip the regular security queue</p>
                                        </span>
                                    </div>
                                    <span class="font-bold">$25</span>
                                </label>

                                <label class="flex items-center justify-between p-4 border rounded-lg cursor-pointer hover:border-primary-600 transition-colors">
                                    <div class="flex items-center">
                                        <input 
                                            type="checkbox"
                                            x-model="addonsSelected.loungeAccess"
                                            class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded">
                                        <span class="ml-3">
                                            <span class="font-medium">Lounge Access</span>
                                            <p class="text-sm text-gray-600">Access to airport lounges</p>
                                        </span>
                                    </div>
                                    <span class="font-bold">$45</span>
                                </label>

                                <label class="flex items-center justify-between p-4 border rounded-lg cursor-pointer hover:border-primary-600 transition-colors">
                                    <div class="flex items-center">
                                        <input 
                                            type="checkbox"
                                            x-model="addonsSelected.priorityBoarding"
                                            class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded">
                                        <span class="ml-3">
                                            <span class="font-medium">Priority Boarding</span>
                                            <p class="text-sm text-gray-600">Board the aircraft first</p>
                                        </span>
                                    </div>
                                    <span class="font-bold">$15</span>
                                </label>
                            </div>
                        </div>

                        <div class="flex justify-between pt-6">
                            <button 
                                @click="currentStep = 1"
                                class="btn-secondary">
                                Back to Details
                            </button>
                            <button 
                                @click="currentStep = 3"
                                class="btn-primary">
                                Review Booking
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Booking Review -->
            <div x-show="currentStep === 3">
                <div class="card">
                    <h3 class="text-xl font-bold mb-6">Review Your Booking</h3>

                    <!-- Flight Summary -->
                    <div class="bg-gray-50 rounded-lg p-4 mb-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium">Emirates EK201</p>
                                <div class="text-sm text-gray-600">Sept 30, 2025</div>
                            </div>
                            <div class="text-right">
                                <p class="font-medium">7h 15m</p>
                                <div class="text-sm text-gray-600">Non-stop</div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between mt-4">
                            <div>
                                <p class="text-sm text-gray-600">10:30</p>
                                <p class="font-medium">New York (JFK)</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm text-gray-600">22:45</p>
                                <p class="font-medium">London (LHR)</p>
                            </div>
                        </div>
                    </div>

                    <!-- Passenger Summary -->
                    <div class="space-y-6">
                        <template x-for="(passenger, index) in passengers" :key="index">
                            <div class="border-b pb-6">
                                <h4 class="font-bold mb-4" x-text="'Passenger ' + (index + 1)"></h4>
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <p class="text-gray-600">Name</p>
                                        <p class="font-medium" x-text="passenger.firstName + ' ' + passenger.lastName"></p>
                                    </div>
                                    <div>
                                        <p class="text-gray-600">Passport</p>
                                        <p class="font-medium" x-text="passenger.passportNumber"></p>
                                    </div>
                                    <div>
                                        <p class="text-gray-600">Seat</p>
                                        <p class="font-medium">12A</p>
                                    </div>
                                    <div>
                                        <p class="text-gray-600">Meal Preference</p>
                                        <p class="font-medium" x-text="addonsSelected.meal || 'Regular'"></p>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>

                    <!-- Add-ons Summary -->
                    <div class="border-t pt-6 mt-6">
                        <h4 class="font-bold mb-4">Selected Add-ons</h4>
                        <div class="space-y-4">
                            <div class="flex justify-between">
                                <span>Baggage</span>
                                <span class="font-medium" x-text="addonsSelected.baggage || 'Standard'"></span>
                            </div>
                            <template x-if="addonsSelected.fastTrack">
                                <div class="flex justify-between">
                                    <span>Fast Track Security</span>
                                    <span class="font-medium">$25</span>
                                </div>
                            </template>
                            <template x-if="addonsSelected.loungeAccess">
                                <div class="flex justify-between">
                                    <span>Lounge Access</span>
                                    <span class="font-medium">$45</span>
                                </div>
                            </template>
                            <template x-if="addonsSelected.priorityBoarding">
                                <div class="flex justify-between">
                                    <span>Priority Boarding</span>
                                    <span class="font-medium">$15</span>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Price Summary -->
                    <div class="border-t pt-6 mt-6">
                        <h4 class="font-bold mb-4">Price Summary</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>Flight Fare (2 passengers)</span>
                                <span class="font-medium">$1,700</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Taxes & Fees</span>
                                <span class="font-medium">$320</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Add-ons</span>
                                <span class="font-medium" x-text="'$' + calculateAddonsTotal()"></span>
                            </div>
                            <div class="flex justify-between text-lg font-bold pt-2 border-t">
                                <span>Total</span>
                                <span x-text="'$' + (2020 + calculateAddonsTotal())"></span>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-between pt-6">
                        <button 
                            @click="currentStep = 2"
                            class="btn-secondary">
                            Back to Add-ons
                        </button>
                        <button 
                            @click="proceedToPayment()"
                            class="btn-primary">
                            Proceed to Payment
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function initializePassengers() {
            // Initialize with 2 empty passenger objects
            this.passengers = Array(2).fill().map(() => ({
                firstName: '',
                lastName: '',
                dob: '',
                gender: '',
                nationality: '',
                passportNumber: '',
                passportExpiry: '',
                email: '',
                phone: ''
            }));
        }

        function savePassengerDetails() {
            if (this.currentPassenger < this.passengers.length) {
                this.currentPassenger++;
            } else {
                this.currentStep = 2;
            }
            showSnackbar('Passenger details saved');
        }

        function previousPassenger() {
            if (this.currentPassenger > 1) {
                this.currentPassenger--;
            }
        }

        function calculateAddonsTotal() {
            let total = 0;
            if (this.addonsSelected.baggage === 'extra') total += 50;
            if (this.addonsSelected.baggage === 'premium') total += 90;
            if (this.addonsSelected.fastTrack) total += 25;
            if (this.addonsSelected.loungeAccess) total += 45;
            if (this.addonsSelected.priorityBoarding) total += 15;
            return total;
        }

        function proceedToPayment() {
            window.location.href = '/payment';
        }
    </script>
</body>
</html>